---
import pb from '../utils/pb';
import flecheIcon from '../assets/svgs/fleche1.svg';

const modeles = await pb.collection('Modeles').getFullList({
  sort: 'created',
});
---

<section class="py-12 bg-base-100">
  <div class="px-0">
    <h2 class="text-3xl font-display font-bold mb-8 px-4">Nos modèles à personnaliser</h2>
    
    <!-- Carousel desktop (≥768px) -->
    <div class="hidden md:flex carousel carousel-center w-full space-x-0">
      {modeles.map((modele) => (
        <div class="carousel-item w-1/4 max-xl:w-1/3 flex-shrink-0">
          <a href={`/personnalisation/${modele.id}`} class="w-full">
            <div class="border border-neutral-300 bg-base-100 p-4 aspect-square flex flex-col">
              <!-- SVG centré en haut -->
              <div class="flex justify-center mb-4">
                <div set:html={modele.svg} class="h-64 w-64 max-xl:h-48 max-xl:w-48 flex items-center justify-center flex-shrink-0" />
              </div>
              
              <!-- Texte à gauche + bouton à droite -->
              <div class="flex-1 flex flex-col justify-between">
                <div class="text-left">
                  <h3 class="font-display font-bold text-sm max-xl:text-xs line-clamp-1">{modele.nom_modele}</h3>
                  <p class="text-xs text-neutral max-xl:text-[10px] line-clamp-1 mb-2">{modele.designation}</p>
                  <p class="text-xs text-neutral max-xl:text-[9px] line-clamp-2 mb-3">{modele.description}</p>
                </div>
                
                <!-- Bas : prix gauche, bouton droite -->
                <div class="flex items-center justify-between">
                  <span class="text-lg font-bold max-xl:text-base">{modele.prix}€*</span>
                  <button class="flex items-center gap-1 text-black font-light text-sm hover:opacity-70 transition-opacity">
                    PERSONNALISER
                    <img src={flecheIcon.src} alt="" class="w-4 h-4" />
                  </button>
                </div>
              </div>
            </div>
          </a>
        </div>
      ))}
    </div>

    <!-- Galerie mobile (<768px) : 2 colonnes -->
    <div class="md:hidden grid grid-cols-2 gap-0">
      {modeles.map((modele) => (
        <a href={`/personnalisation/${modele.id}`} class="w-full">
          <div class="border border-neutral-300 bg-base-100 p-3 aspect-square flex flex-col">
            <!-- SVG centré -->
            <div class="flex justify-center mb-2">
              <div set:html={modele.svg} class="h-20 w-20 flex items-center justify-center flex-shrink-0" />
            </div>
            
            <!-- Contenu texte -->
            <div class="flex-1 flex flex-col justify-between">
              <div class="text-left text-xs">
                <h3 class="font-display font-bold text-xs line-clamp-1">{modele.nom_modele}</h3>
                <p class="text-xs text-neutral line-clamp-1 mb-1">{modele.designation}</p>
                <p class="text-xs text-neutral line-clamp-2 mb-2">{modele.description}</p>
              </div>
              
              <!-- Bas -->
              <div class="flex items-center justify-between">
                <span class="font-bold text-xs">{modele.prix}€*</span>
                <button class="flex items-center gap-1 text-black font-light text-xs hover:opacity-70 transition-opacity">
                  <img src={flecheIcon.src} alt="" class="w-3 h-3" />
                </button>
              </div>
            </div>
          </div>
        </a>
      ))}
    </div>
  </div>
</section>

<style>
  .carousel {
    scroll-behavior: smooth;
    scroll-padding: 0;
  }
  
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
